<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<title>一键办理</title>
<link href="css/base.css" type="text/css" rel="stylesheet">
<link href="css/addlv.css" type="text/css" rel="stylesheet">
</head>
<body class="body">
<<<<<<< HEAD
    
    <div class="preview">
        <div class="preview_img" >
            <img src="images/preview3.png" id="preview_img"/>
        </div>
        <div class="preview_num" id="preview_num" ><span>金额</span></div>
        <div class="preview_msg" id="preview_msg">事项</div>
        <div class="preview_delete" id="preview_delete">
            <a href="#"><img src="images/delete3.png"/></a>
        </div>   
=======
    <div class="title">
    	<img src="images/income.png">
        <div class="title-mid">
    	<span>+300</span>
    	<span>四海一家</span>
       </div>
    	<div class="title-rt" id="title-rt">
    		<div class="in">&times;
    		</div>
    	</div>
>>>>>>> f87c2ffc0051d9a52bb78c52dd76a207c2abe55c
    </div>
    <div class="choose">
        <p>选择账目类型</p>
        <ul class="choose-img" id='choose'>
            <li><img src="images/food.png" alt='food' data-id='food'></li>
            <li><img src="images/dress.png" alt='dress' data-id='dress'></li>
            <li><img src="images/transport.png" alt='transport' data-id='transport'></li>
            <li><img src="images/shopping.png" alt='shopping' data-id='shopping'></li>
            <li><img src="images/income.png" alt='income' data-id='income'></li>
        </ul>
    </div>
    <div class="project">
        <div class="o"></div>
<<<<<<< HEAD
        <span>事项</span><input type="text" id="msg"/>
    </div>
    <div class="project">
        <div class="o"></div>
        <span>金额</span><input type="text" id="money"/>
    </div>
    <button class="but" id="save">保存</button>
    <!--
=======
        <span>事项</span><input type="text" id="msg">
    </div>
    <div class="project">
        <div class="o"></div>
        <span>金额</span><input type="text" id="money">
    </div>
    <button class="but" id="save">保存</button>
>>>>>>> f87c2ffc0051d9a52bb78c52dd76a207c2abe55c
    <script type="text/javascript">  
            //全局变量，触摸开始位置  
            var startX = 0, startY = 0;  
            var titlert=document.getElementById("title-rt"); 
            var title=document.getElementsByClassName("title-rt");
            //touchstart事件  
            function touchSatrtFunc(evt) {  
                try  
                {  
                    evt.preventDefault(); //阻止触摸时浏览器的缩放、滚动条滚动等  
  
                    var touch = evt.touches[0]; //获取第一个触点  
                    var x = Number(touch.pageX); //页面触点X坐标  
                    startX = x;  
                    startY = y;  
  
                }  
                catch (e) {  
                    alert('touchSatrtFunc：' + e.message);  
                }  
            }  
  
            //touchmove事件，这个事件无法获取坐标  
            function touchMoveFunc(evt) {  
                try  
                {  
                    evt.preventDefault(); //阻止触摸时浏览器的缩放、滚动条滚动等  
                    var touch = evt.touches[0]; //获取第一个触点  
                    var x = Number(touch.pageX); //页面触点X坐标  
                   
  
                    //判断滑动方向  
                    if ( startX-x >5) {  
                        text += '<br/>左右滑动';  
                    }  
                }  
                catch (e) {  
                    alert('touchMoveFunc：' + e.message);  
                }  
            }  
  
           
            function bindEvent() {  
                title.addEventListener('touchstart', touchSatrtFunc, false);  
                title.addEventListener('touchmove', touchMoveFunc, false);  
                title.addEventListener('touchend', touchEndFunc, false);  
            }  
  
            bindEvent();
<<<<<<< HEAD
    </script> 
!-->
    <script src='js/zepto.min.js'></script>
    <script src='js/util.js'></script>
    <script>
    (function(){
=======
    </script>  
    <script src='js/util.js'></script>
    <script>
        (function(){
>>>>>>> f87c2ffc0051d9a52bb78c52dd76a207c2abe55c
            var category;
            var choose = util.$('choose');
            var msg = util.$('msg');
            var money = util.$('money');
            var save = util.$('save');
<<<<<<< HEAD
            var target_in;
            var preview_num = util.$('preview_num');
            var preview_msg = util.$('preview_msg');
        
        //选择账目事件
        $('#choose').tap(function(event){
            //util.addEvent(choose,'touchstart',function(event){
                var e = util.getEvent(event);
                target_touch = util.getTarget(e);
                if(target_touch.parentNode.parentNode==choose){
                    if(!category){
                        category = target_touch.dataset.id;
                        target_touch.className='choose_img';
                        target_in = target_touch;
                    }else{
                        target_in.className='';
                        category=target_touch.dataset.id;
                        target_touch.className='choose_img';
                        target_in = target_touch;
                    }
                    util.$('preview_img').src='images/'+category+'.png';
                    if(money.value){
                        var colorClass2= category=='income'?'earn' : 'cost',
                            symbol2 =  category == 'income'? '+':'-';
                        preview_num.className = "preview_num "+colorClass2;
                        preview_num.innerHTML='<span>'+symbol2+money.value+'</span>';
                    }
                }
            });
        
        //实时预览
            if('\v'=='v'){
                money.onpropertychange = previewNum;
                msg.onpropertychange = previewMsg;
            }else{
                util.addEvent(money,'input',previewNum);
                util.addEvent(msg,'input',previewMsg);
            }
            function previewNum(){
                if(money){
                    preview_num.innerHTML='';
                    var colorClass2= category=='income'?'earn' : 'cost',
                        symbol2 =  category == 'income'? '+':'-';
                    preview_num.className = "preview_num "+colorClass2;
                    preview_num.innerHTML='<span>'+symbol2+money.value+'</span>';
                }
            }
            function previewMsg(){
                if(msg){
                    preview_msg.innerHTML=msg.value;
                }
            }
        
        //删除
            var preview_delete=util.$('preview_delete');
        $('#preview_delete').tap(function(event){
            //util.addEvent(preview_delete,'touchstart',function(event){
                event=util.getEvent(event);
                util.preventEvent(event);
                preview_num.innerHTML='<span>金额</span>';
                preview_msg.innerHTML='事项';
                util.$('preview_img').src='images/preview3.png';
                target_touch.className='';
                target_touch=null;
                msg.value='';
                money.value='';
            });
                    
        
        //保存
        $('#save').tap(function(event){
            //util.addEvent(save,'touchstart',function(event){
               if(category && msg.value && money.value){
                    var count = localStorage.count ? Number(localStorage.count) : 0;
                    var now = new Date();
                    var month = now.getMonth()+1;
                    var dataObj = {money:money.value,msg:msg.value,mont:month};
                    count += 1;
                    localStorage.count = count;
                    util.saveData(count+category, dataObj);
                    
                    window.location.href = 'index.html';
                    
               }else if(!category){
                   alert('请选择账目类型');
               }else if(!msg.value){
                   alert('请输入事项');
               }else if(!money.value){
                   alert('请输入金额');
               }
            });
    })();
=======
            util.addEvent(choose,'click',function(event){
                var e = util.getEvent(event);
                var target = util.getTarget(e);
                category = target.dataset.id;
            });
            util.addEvent(save,'click',function(event){
               if(category){
                    var count = localStorage.count ? Number(localStorage.count) : 0;
                    var dataObj = {money:money.value,msg:msg.value};
                    count += 1;
                    localStorage.count = count;
                    util.saveData(category + count, dataObj);
                    
                    window.location.href = 'index.html';
                    
               }else{
                    alert('请先选择账目类型');
               }
            });

        })();
>>>>>>> f87c2ffc0051d9a52bb78c52dd76a207c2abe55c
    </script>
</body>
</html>
